# Управление кампаниями

Базовый домен: `https://advert-api.wildberries.ru`

## Статусы кампаний (используются в методах управления)

- `-1` — удаляется
- `4` — готова к запуску
- `7` — завершена
- `8` — отменена
- `9` — активна
- `11` — на паузе

---

## 1) GET `/adv/v0/delete`

**Назначение:** удалить кампанию в статусе `4` (готова к запуску).

### Особенности

- После вызова кампания переходит в `-1` (в процессе удаления).
- Полное удаление занимает примерно от 3 до 10 минут.

### Лимит

- `1 сек`: 5 запросов, интервал `200 мс`, всплеск 5.

### Пример

```bash
curl -G "https://advert-api.wildberries.ru/adv/v0/delete" \
  -H "Authorization: $WB_API_TOKEN" \
  --data-urlencode "id=1234"
```

### Параметры

| Параметр | Тип | Обяз. | Описание |
|---|---|---|---|
| `id` | integer | да | ID кампании |

### Ответы

- `200` — успех, тела нет.
- `400` — ошибка (`responseAdvError1`, пример: некорректный ID).
- `401`, `429`.

---

## 2) POST `/adv/v0/rename`

**Назначение:** переименовать кампанию.

### Лимит

- `1 сек`: 5 запросов, интервал `200 мс`, всплеск 5.

### Пример

```bash
curl -X POST "https://advert-api.wildberries.ru/adv/v0/rename" \
  -H "Authorization: $WB_API_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"advertId": 2233344, "name": "newname"}'
```

### Тело запроса

| Поле | Тип | Обяз. | Описание |
|---|---|---|---|
| `advertId` | integer | да | ID кампании |
| `name` | string | да | Новое название, максимум 100 символов |

### Ответы

- `200` — успех.
- `400` — текстовая ошибка (`Некорректный ID РК`, `Некорректное название` и т.д.).
- `422` — ошибка обработки параметров/тела.
- `401`, `429`.

---

## 3) GET `/adv/v0/start`

**Назначение:** запустить кампанию в статусе `4` или `11`.

### Особенности

- Перед запуском проверьте бюджет. Если бюджет недостаточен, метод вернёт ошибку.

### Лимит

- `1 сек`: 5 запросов, интервал `200 мс`, всплеск 5.

### Пример

```bash
curl -G "https://advert-api.wildberries.ru/adv/v0/start" \
  -H "Authorization: $WB_API_TOKEN" \
  --data-urlencode "id=1234"
```

### Параметры

| Параметр | Тип | Обяз. | Описание |
|---|---|---|---|
| `id` | integer | да | ID кампании |

### Ответы

- `200` — успех.
- `400` — неверный ID/кампания не найдена/низкий бюджет (`400Response`).
- `422` — статус не изменён.
- `401`, `429`.

---

## 4) GET `/adv/v0/pause`

**Назначение:** поставить на паузу кампанию в статусе `9`.

### Лимит

- `1 сек`: 5 запросов, интервал `200 мс`, всплеск 5.

### Пример

```bash
curl -G "https://advert-api.wildberries.ru/adv/v0/pause" \
  -H "Authorization: $WB_API_TOKEN" \
  --data-urlencode "id=1234"
```

### Параметры

| Параметр | Тип | Обяз. | Описание |
|---|---|---|---|
| `id` | integer | да | ID кампании |

### Ответы

- `200` — успех.
- `400` — неверный ID/кампания не найдена.
- `422` — статус не изменён.
- `401`, `429`.

---

## 5) GET `/adv/v0/stop`

**Назначение:** завершить кампанию в статусе `4`, `9` или `11`.

### Лимит

- `1 сек`: 5 запросов, интервал `200 мс`, всплеск 5.

### Пример

```bash
curl -G "https://advert-api.wildberries.ru/adv/v0/stop" \
  -H "Authorization: $WB_API_TOKEN" \
  --data-urlencode "id=1234"
```

### Параметры

| Параметр | Тип | Обяз. | Описание |
|---|---|---|---|
| `id` | integer | да | ID кампании |

### Ответы

- `200` — успех.
- `400` — неверный ID/кампания не найдена.
- `422` — статус не изменён.
- `401`, `429`.

---

## 6) PUT `/adv/v0/auction/placements`

**Назначение:** изменить места размещения в кампаниях с **ручной ставкой** и `payment_type=cpm`.

### Применимость

- Для кампаний в статусах `4`, `9`, `11`.

### Лимит

- `1 сек`: 1 запрос, интервал `1 сек`, всплеск 1.

### Пример

```bash
curl -X PUT "https://advert-api.wildberries.ru/adv/v0/auction/placements" \
  -H "Authorization: $WB_API_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "placements": [
      {
        "advert_id": 12345,
        "placements": {"search": true, "recommendations": true}
      }
    ]
  }'
```

### Тело запроса

| Поле | Тип | Обяз. | Ограничения |
|---|---|---|---|
| `placements` | array<object> | да | максимум 50 кампаний |

Элемент `placements[]`:

| Поле | Тип | Обяз. | Описание |
|---|---|---|---|
| `advert_id` | int64 | да | ID кампании |
| `placements.search` | boolean | да | размещение в поиске |
| `placements.recommendations` | boolean | да | размещение в рекомендациях |

### Ответы

- `204` — успех, тела нет.
- `400` — некорректное тело/тип оплаты не подходит.
- `401`, `429`.

---

## 7) PATCH `/api/advert/v1/bids`

**Назначение:** изменить ставки карточек товаров в кампаниях (ручная/единая ставка).

### Применимость

- Для кампаний в статусах `4`, `9`, `11`.

### Важное правило `placement`

- `combined` — для кампаний с **единой** ставкой.
- `search` или `recommendations` — для кампаний с **ручной** ставкой.

### Лимит

- `1 сек`: 5 запросов, интервал `200 мс`, всплеск 5.

### Пример

```bash
curl -X PATCH "https://advert-api.wildberries.ru/api/advert/v1/bids" \
  -H "Authorization: $WB_API_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "bids": [
      {
        "advert_id": 12345,
        "nm_bids": [
          {"nm_id": 13335157, "bid_kopecks": 250, "placement": "recommendations"}
        ]
      }
    ]
  }'
```

### Тело запроса

| Поле | Тип | Обяз. | Ограничения |
|---|---|---|---|
| `bids` | array<object> | да | максимум 50 кампаний |

Элемент `bids[]`:

| Поле | Тип | Обяз. | Описание |
|---|---|---|---|
| `advert_id` | int64 | да | ID кампании |
| `nm_bids` | array<object> | да | максимум 50 ставок в кампании |

Элемент `nm_bids[]`:

| Поле | Тип | Обяз. | Описание |
|---|---|---|---|
| `nm_id` | int64 | да | Артикул WB |
| `bid_kopecks` | int64 | да | Ставка, копейки |
| `placement` | enum | да | `search`, `recommendations`, `combined` |

### Ответ `200`

Возвращает объект `bids[]` с фактически применёнными значениями (`advert_id`, `nm_bids[]`).

### Ошибки

- `400` — неверные ставки или другие ошибки валидации.
- `401`, `429`.

---

## 8) PATCH `/adv/v0/auction/nms`

**Назначение:** добавить/удалить карточки товаров в кампаниях.

### Применимость

- Для кампаний в статусах `4`, `9`, `11`.
- Для добавляемых товаров система ставит текущую минимальную ставку.

### Лимит

- `1 сек`: 1 запрос, интервал `1 сек`, всплеск 1.

### Пример

```bash
curl -X PATCH "https://advert-api.wildberries.ru/adv/v0/auction/nms" \
  -H "Authorization: $WB_API_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "nms": [
      {
        "advert_id": 12345,
        "nms": {"add": [11111111, 44444444], "delete": [55555555]}
      }
    ]
  }'
```

### Тело запроса

| Поле | Тип | Обяз. | Ограничения |
|---|---|---|---|
| `nms` | array<object> | да | максимум 20 кампаний в запросе |

Элемент `nms[]`:

| Поле | Тип | Обяз. | Описание |
|---|---|---|---|
| `advert_id` | int64 | да | ID кампании |
| `nms.add` | array<int> | нет | Товары для добавления (до 50 на кампанию) |
| `nms.delete` | array<int> | нет | Товары для удаления |

### Ответ `200`

Возвращает подтверждение по каждой кампании:
- `advert_id`
- `nms.added[]`
- `nms.deleted[]`

### Ошибки

- `400` — ошибки валидации (например, один `nm` одновременно в `add` и `delete`).
- `401`, `429`.
